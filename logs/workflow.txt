=== Log started at 2025-12-08 19:18:45.802184 ===
[2025-12-08 19:18:45] ðŸš€ Starting full customer analysis workflow.
[2025-12-08 19:18:45] Step 1: Cleaning raw datasets...
[2025-12-08 19:18:45] Starting data cleaning. Raw path: /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/raw
[2025-12-08 19:18:45] Loaded campaign_desc.csv (shape: (30, 4))
[2025-12-08 19:18:45] Loaded campaign_table.csv (shape: (7208, 3))
[2025-12-08 19:18:45] Loaded coupon.csv (shape: (124548, 3))
[2025-12-08 19:18:45] Loaded coupon_redempt.csv (shape: (2318, 4))
[2025-12-08 19:19:14] Loaded causal_data.csv (shape: (36786524, 5))
[2025-12-08 19:19:14] Loaded product.csv (shape: (92353, 7))
[2025-12-08 19:19:18] Loaded transaction_data.csv (shape: (2595732, 12))
[2025-12-08 19:19:18] Loaded hh_demographic.csv (shape: (801, 8))
[2025-12-08 19:19:18] === Cleaning campaign_desc.csv ===
[2025-12-08 19:19:18] Raw shape: (30, 4)
[2025-12-08 19:19:18] campaign_desc.csv: No duplicates.
[2025-12-08 19:19:18] Cleaned shape: (30, 4)
[2025-12-08 19:19:18] === Cleaning campaign_table.csv ===
[2025-12-08 19:19:18] Raw shape: (7208, 3)
[2025-12-08 19:19:18] campaign_table.csv: No duplicates.
[2025-12-08 19:19:18] Cleaned shape: (7208, 3)
[2025-12-08 19:19:18] === Cleaning coupon.csv ===
[2025-12-08 19:19:18] Raw shape: (124548, 3)
[2025-12-08 19:19:18] coupon.csv: Removed 5164 duplicates (4.15%).
[2025-12-08 19:19:18] Cleaned shape: (119384, 3)
[2025-12-08 19:19:18] === Cleaning coupon_redempt.csv ===
[2025-12-08 19:19:18] Raw shape: (2318, 4)
[2025-12-08 19:19:18] coupon_redempt.csv: No duplicates.
[2025-12-08 19:19:18] Cleaned shape: (2318, 4)
[2025-12-08 19:19:18] === Cleaning causal_data.csv ===
[2025-12-08 19:19:18] Raw shape: (36786524, 5)
[2025-12-08 19:19:45] causal_data.csv: No duplicates.
[2025-12-08 19:23:23] Cleaned shape: (36786524, 5)
[2025-12-08 19:23:23] === Cleaning product.csv ===
[2025-12-08 19:23:23] Raw shape: (92353, 7)
[2025-12-08 19:23:23] product.csv: No duplicates.
[2025-12-08 19:23:23] product.csv: DEPARTMENT has 15 missing (0.02%).
[2025-12-08 19:23:23] product.csv: COMMODITY_DESC has 15 missing (0.02%).
[2025-12-08 19:23:23] product.csv: SUB_COMMODITY_DESC has 15 missing (0.02%).
[2025-12-08 19:23:23] product.csv: CURR_SIZE_OF_PRODUCT has 30607 missing (33.14%).
[2025-12-08 19:23:23] Cleaned shape: (92353, 7)
[2025-12-08 19:23:23] === Cleaning transaction_data.csv ===
[2025-12-08 19:23:23] Raw shape: (2595732, 12)
[2025-12-08 19:23:52] transaction_data.csv: No duplicates.
[2025-12-08 19:24:24] Cleaned shape: (2595732, 12)
[2025-12-08 19:24:24] transaction_data.csv: Removed 18917 invalid rows.
[2025-12-08 19:24:24] === Cleaning hh_demographic.csv ===
[2025-12-08 19:24:24] Raw shape: (801, 8)
[2025-12-08 19:24:24] hh_demographic.csv: No duplicates.
[2025-12-08 19:24:24] hh_demographic.csv: MARITAL_STATUS_CODE has 344 missing (42.95%).
[2025-12-08 19:24:24] hh_demographic.csv: HOMEOWNER_DESC has 233 missing (29.09%).
[2025-12-08 19:24:24] hh_demographic.csv: HH_COMP_DESC has 73 missing (9.11%).
[2025-12-08 19:24:24] Cleaned shape: (801, 8)
[2025-12-08 19:24:24] Saved cleaned dataset: /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/cleaned/campaign_desc_cleaned.csv
[2025-12-08 19:24:24] Saved cleaned dataset: /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/cleaned/campaign_table_cleaned.csv
[2025-12-08 19:24:25] Saved cleaned dataset: /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/cleaned/coupon_cleaned.csv
[2025-12-08 19:24:25] Saved cleaned dataset: /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/cleaned/coupon_redempt_cleaned.csv
[2025-12-08 19:25:54] Saved cleaned dataset: /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/cleaned/causal_data_cleaned.csv
[2025-12-08 19:25:55] Saved cleaned dataset: /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/cleaned/product_cleaned.csv
[2025-12-08 19:26:17] Saved cleaned dataset: /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/cleaned/transaction_data_cleaned.csv
[2025-12-08 19:26:17] Saved cleaned dataset: /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/cleaned/hh_demographic_cleaned.csv
[2025-12-08 19:26:17] Data cleaning completed successfully.
[2025-12-08 19:26:17] âœ” Step 1 complete. Cleaned data saved to: data/cleaned/
[2025-12-08 19:26:17] Step 2: Running customer analysis pipeline...
[2025-12-08 19:26:17] === Customer Analysis Pipeline Started ===
[2025-12-08 19:26:20] Loaded transaction_data_cleaned.csv with shape (2576815, 12)
[2025-12-08 19:26:20] Loaded product_cleaned.csv with shape (92353, 7)
[2025-12-08 19:26:20] Loaded hh_demographic_cleaned.csv with shape (801, 8)
[2025-12-08 19:26:20] Merging datasets...
[2025-12-08 19:26:21] After merging demographics: (2576815, 19)
[2025-12-08 19:26:22] After merging products: (2576815, 25)
[2025-12-08 19:26:25] Dropped 1747722 rows with missing critical demographics (67.82%)
[2025-12-08 19:26:25] Aggregating household-level metrics...
[2025-12-08 19:26:25] Aggregated 457 households
[2025-12-08 19:26:26] Dropped 43 households with missing demographics (9.41%)
[2025-12-08 19:26:26] Saved pie chart: age_desc_piechart.png
[2025-12-08 19:26:26] Saved pie chart: marital_status_code_piechart.png
[2025-12-08 19:26:26] Saved pie chart: income_desc_piechart.png
[2025-12-08 19:26:26] Saved pie chart: homeowner_desc_piechart.png
[2025-12-08 19:26:26] Saved pie chart: hh_comp_desc_piechart.png
[2025-12-08 19:26:27] Saved pie chart: household_size_desc_piechart.png
[2025-12-08 19:26:27] Saved pie chart: kid_category_desc_piechart.png
[2025-12-08 19:26:27] Saved aggregated metric chart: total_spent_vs_income_desc.png
[2025-12-08 19:26:27] Saved aggregated metric chart: total_spent_vs_age_desc.png
[2025-12-08 19:26:28] Saved aggregated metric chart: num_transactions_vs_income_desc.png
[2025-12-08 19:26:28] Saved aggregated metric chart: num_transactions_vs_age_desc.png
[2025-12-08 19:26:28] === Customer Analysis Pipeline Completed ===
[2025-12-08 19:26:28] âœ” Step 2 complete. Results saved to: data/customer_segmentation/
[2025-12-08 19:26:28] ðŸŽ‰ Workflow completed successfully!
