Provenance log started: 2025-10-25 20:26:23
2025-10-25 20:26:33 - Cleaned datasets loaded: hh_demo, transactions, products, coupon_redempt, campaign_desc.
2025-10-25 20:26:37 - Merged household demographics into transactions.
2025-10-25 20:26:40 - Merged product info into transactions.
2025-10-25 20:27:39 - Saved merged transactions to /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/transactions_merged.csv. Shape: (2576815, 25) with  Columns:  ['household_key', 'BASKET_ID', 'DAY', 'PRODUCT_ID', 'QUANTITY', 'SALES_VALUE', 'STORE_ID', 'RETAIL_DISC', 'TRANS_TIME', 'WEEK_NO', 'COUPON_DISC', 'COUPON_MATCH_DISC', 'AGE_DESC', 'MARITAL_STATUS_CODE', 'INCOME_DESC', 'HOMEOWNER_DESC', 'HH_COMP_DESC', 'HOUSEHOLD_SIZE_DESC', 'KID_CATEGORY_DESC', 'MANUFACTURER', 'DEPARTMENT', 'BRAND', 'COMMODITY_DESC', 'SUB_COMMODITY_DESC', 'CURR_SIZE_OF_PRODUCT']
2025-10-25 20:28:00 - Merged Transactions loaded. Shape: (2576815, 25) Columns: Index(['household_key', 'BASKET_ID', 'DAY', 'PRODUCT_ID', 'QUANTITY',
       'SALES_VALUE', 'STORE_ID', 'RETAIL_DISC', 'TRANS_TIME', 'WEEK_NO',
       'COUPON_DISC', 'COUPON_MATCH_DISC', 'AGE_DESC', 'MARITAL_STATUS_CODE',
       'INCOME_DESC', 'HOMEOWNER_DESC', 'HH_COMP_DESC', 'HOUSEHOLD_SIZE_DESC',
       'KID_CATEGORY_DESC', 'MANUFACTURER', 'DEPARTMENT', 'BRAND',
       'COMMODITY_DESC', 'SUB_COMMODITY_DESC', 'CURR_SIZE_OF_PRODUCT'],
      dtype='object')
2025-10-25 20:28:08 - Dropped 1747722 rows with missing/unknown MARITAL_STATUS_CODE or INCOME_DESC (67.82% of total).
2025-10-25 20:28:08 - Shape after drop: (829093, 25)
2025-10-25 20:28:08 - Starting household-level aggregation...
2025-10-25 20:28:10 - Aggregated 2500 households. Columns: ['household_key', 'total_spent', 'total_quantity', 'num_transactions', 'num_coupons_redeemed', 'avg_basket_size', 'coupon_redemption_rate']
2025-10-25 20:28:11 - Merged demographic data. Shape after merge: (2500, 14)
2025-10-25 20:28:12 - Dropped 2338 households with missing/unknown demographic values (93.52%).
2025-10-25 20:28:12 - Final aggregated dataset shape: (162, 14)
2025-10-25 20:28:12 - Sample of aggregated data:
2025-10-25 20:28:12 -    household_key  total_spent  total_quantity  num_transactions  \
0             43       884.84           43025               106   
1             46      8433.43           94957               137   
2             56      6691.53           11124               201   
3             58     10367.08         1209022               268   
4             67      9618.90          340330               226   

   num_coupons_redeemed  avg_basket_size  coupon_redemption_rate AGE_DESC  \
0                   0.0       405.896226                     0.0    35-44   
1                   0.0       693.116788                     0.0    45-54   
2                   0.0        55.343284                     0.0    55-64   
3                   0.0      4511.276119                     0.0    25-34   
4                   0.0      1505.884956                     0.0    45-54   

  MARITAL_STATUS_CODE INCOME_DESC HOMEOWNER_DESC   HH_COMP_DESC  \
0                   B      15-24K      Homeowner  2 Adults Kids   
1                   A    150-174K      Homeowner  2 Adults Kids   
2                   A    100-124K      Homeowner  2 Adults Kids   
3                   A    150-174K      Homeowner  2 Adults Kids   
4                   A   Under 15K      Homeowner  2 Adults Kids   

  HOUSEHOLD_SIZE_DESC KID_CATEGORY_DESC  
0                  5+                3+  
1                  5+                3+  
2                   4                 2  
3                   4                 2  
4                  5+                3+  
2025-10-25 20:28:12 - Starting demographic distribution pie chart generation...
2025-10-25 20:28:12 - Saved pie chart for AGE_DESC to /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/figures/age_desc_piechart.png
2025-10-25 20:28:12 - Saved pie chart for MARITAL_STATUS_CODE to /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/figures/marital_status_code_piechart.png
2025-10-25 20:28:12 - Saved pie chart for INCOME_DESC to /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/figures/income_desc_piechart.png
2025-10-25 20:28:12 - Saved pie chart for HOMEOWNER_DESC to /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/figures/homeowner_desc_piechart.png
2025-10-25 20:28:12 - Saved pie chart for HH_COMP_DESC to /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/figures/hh_comp_desc_piechart.png
2025-10-25 20:28:12 - Saved pie chart for HOUSEHOLD_SIZE_DESC to /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/figures/household_size_desc_piechart.png
2025-10-25 20:28:12 - Saved pie chart for KID_CATEGORY_DESC to /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/figures/kid_category_desc_piechart.png
2025-10-25 20:28:12 - Completed saving all demographic pie charts to /Users/aravind/Premnisha/MS/data_curation/customer-analysis/data/customer_segmentation/figures
